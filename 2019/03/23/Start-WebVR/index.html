


<!DOCTYPE html>
<html lang="English">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Start WebVR [ Hayden&#39;s Journal ]</title>
  <meta name="baidu-site-verification" content="86burbRUA2" />
  <meta name="google-site-verification" content="ddD504LkQFv-uiU4zbpAwPJVWsp0KOc-PDdg5ZX1MtU" />
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/hhy.css">
    
  
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- jQuery -->
    <script type="text/javascript">
      window.onload = function(){
          var parallax = new Parallax(document.getElementById('scene'));
           
      }
     
    </script>
  
  
            
</head>
<body>


<div id="menu-outer">

  <div id="menu-inner">
    
    

    <nav class="navbar navbar-expand-lg navbar-light ">
      <a class="navbar-brand" href="#"> Hayden's Journal </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          
            <li><a class="nav-item nav-link " href="/">Home</a></li>
          
            <li><a class="nav-item nav-link " href="/archives">Archives</a></li>
          
            <li><a class="nav-item nav-link " href="/about">About</a></li>
          
          

        </div>
      </div>
    </nav>
    <!-- nav -->  
  </div>
</div>

<div id="content-outer" class="container-fluid">
  <div id="content-inner" class="row">
    

<div id="post-container" class="col-sm-12 col-md-10 offset-md-0">
	<div class="col-12"><h1 class="holder" >&nbsp</h1></div>
	
	
	<div class="row">
		
		
		<div id="post-head" class="col-12 col-md-3 m-sm-0 mr-md-5  d-md-inline-block">
			<h1 class="article-title">Start WebVR</h1>
			<span class="article-tags">
				 
					

<a class="post-tag" href="/tags/Javascript/">Javascript</a> <a class="post-tag" href="/tags/animation/">animation</a> <a class="post-tag" href="/tags/Web/">Web</a> <a class="post-tag" href="/tags/WebVR/">WebVR</a> <a class="post-tag" href="/tags/ThreeJS/">ThreeJS</a>


			</span>
			<div class="post-list-box col p-0 m-0">
				<div class="col-sm-12 p-0">
	<div class="col-12"><h1 class="holder" >&nbsp</h1></div>
	
	<div id="post-list" class=" col-md-12 d-none d-sm-block mt-3 p-0">
		
		
		<h2 class="col-sm-10 float-left">All post</h2>
		<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/23/Music-and-narrative/">Music and narrative</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/07/Family-in-Asian/">Family in Asian</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/24/Host-a-Website/">Host a Website</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/23/Start-WebVR/">Start WebVR</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/11/about-FMP/">about FMP</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/07/Research-Editing/">Research: Hitchcock</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/07/Explore-Blender/">Explore Blender</a></li></ul>
		<div id="post-list-more" class="col-12"><a  href="/archives">More</a></div>
	</div>
</div>
	
			</div>
		</div>

		<article id="post" class="rounded-bottom col-12 col-md  offset-md-0 p-0 ">
		  <div class="col-sm-12 col-md">
		  	<h1 id="Whatâ€™s-VR"><a href="#Whatâ€™s-VR" class="headerlink" title="Whatâ€™s VR"></a>Whatâ€™s VR</h1><p>Simply say, VR (<strong>Virtual reality</strong>) is a kind of technology which support real visual. It create to sight of a object, to insprire sense of eyes and lie our brand to believe that is true. The principle of VR is create <strong>Two scene</strong> with a <strong>tiny differnce of angle</strong> to imitate the distance of our two eyes.</p>
<p>Therefore WebVR is using same principle to create VR on Web, it use Three.js to create 3D object, and render it as <strong>2 scenes</strong>.</p>
<h2 id="Web-polyfill"><a href="#Web-polyfill" class="headerlink" title="Web polyfill"></a>Web polyfill</h2><p>First step, declare a <em>WebPolyfill</em> class:</p>
<pre><code>var config = (function() {
    var config = {};
    var q = window.location.search.substring(1);
    if (q === &#39;&#39;) {
        return config;
    }
    var params = q.split(&#39;&amp;&#39;);
    var param, name, value;
    for (var i = 0; i &lt; params.length; i++) {
        param = params[i].split(&#39;=&#39;);
        name = param[0];
        value = param[1];
        // All config values are either boolean or float
        config[name] = value === &#39;true&#39; ? true :
            value === &#39;false&#39; ? false :
                parseFloat(value);
    }
    return config;
})();

var polyfill = new WebVRPolyfill(config);
</code></pre><p>å› ä¸ºVRéœ€è¦æä¾›ä¸¤ä¸ªç”»é¢æ¥åˆ¶é€ è§†è§‰å·®,æ‰€ä»¥è¦ä½¿ç”¨æ•ˆæœå™¨æ¥æŠŠæ¸²æŸ“å™¨çš„ç”»é¢ä¸€åˆ†ä¸ºäºŒ, è¿™ä¸ªæ­¥éª¤ä½¿ç”¨å¤§ä½¬åšçš„åº“å°±å¥½äº†:</p>
<pre><code> var canvas = renderer.domElement
document.body.appendChild(canvas);

var effect = new THREE.VREffect(renderer);
effect.setSize(canvas.clientWidth, canvas.clientHeight, false);
</code></pre><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å…è®¸æµè§ˆå™¨å¤„ç† <em>Polyfill</em> åœ¨ç§»åŠ¨è®¾å¤‡ä¸Š. ä¹‹å, æˆ‘ä»¬éœ€è¦è·å¾—ç”¨æˆ·æ­£åœ¨ä½¿ç”¨çš„VRè®¾å¤‡,ç„¶åæŠŠå®ƒä»£å…¥å…¨å±€å˜é‡:</p>
<pre><code>var vrDisplay, controls;
navigator.getVRDisplays().then(function (vrDisplays) {
    if (vrDisplays.length) {
        vrDisplay = vrDisplays[0];
        // å¦‚æœè¯†åˆ«åˆ°äº†æ˜¾ç¤ºè®¾å¤‡,åˆ™ä»£å…¥å…¨å±€å˜é‡
        controls = new THREE.VRControls(camera);
        // ç„¶åä½¿ç”¨VRæ§åˆ¶æ–¹æ³•

        vrDisplay.requestAnimationFrame(animate);
    }
    else {
        // å¦‚æœæ²¡æœ‰VRæ˜¾ç¤ºè®¾å¤‡,åˆ™ä½¿ç”¨Orbitæ§åˆ¶å™¨
        controls = new THREE.OrbitControls(controlGroup,canvas);
        controls.target.set(0, 0, -1);

        var enterVRButton = document.querySelector(&#39;#vr&#39;);
        enterVRButton.disabled = true;

        requestAnimationFrame(animate);
    }
});
</code></pre><p>æ— è®ºæœ‰æ²¡æœ‰è¯†åˆ«åˆ°vræ˜¾ç¤ºè®¾å¤‡, animationå‡½æ•°éƒ½ä¼šè¢«æ‰§è¡Œ, ä½†æ˜¯ä¸åŒçš„æ˜¯,å½“ä½¿ç”¨vrè®¾å¤‡æ—¶,æˆ‘ä»¬è¦è°ƒç”¨æ˜¯ vrè®¾å¤‡çš„RAFæ–¹æ³•. ä¸‹ä¸€æ­¥,æˆ‘ä»¬å¯ä»¥ç®€å•å†™ä¸€ä¸‹animationå‡½æ•°é‡Œçš„requestAnimationFrame:</p>
<pre><code>effect.render(scene, camera); 
// ä½¿ç”¨æ•ˆæœå™¨

funciton animate(timestamp){
    if (vrDisplay) {
        vrDisplay.requestAnimationFrame(animate);
    } else {
        requestAnimationFrame(animate);
    }
}
</code></pre><h1 id="å½¢æ€é”®åŠ¨ç”»"><a href="#å½¢æ€é”®åŠ¨ç”»" class="headerlink" title="å½¢æ€é”®åŠ¨ç”»"></a>å½¢æ€é”®åŠ¨ç”»</h1><p>åœ¨THREE.jsé‡Œ,æ”¯æŒçš„3DåŠ¨ç”»ç±»å‹æœ‰:</p>
<ol>
<li>å½¢æ€é”® shapeKey</li>
<li>ä½ç½®/æ—‹è½¬/æ¯”ä¾‹ çš„å…³é”®å¸§åŠ¨ç”» and morph weights</li>
<li>éª¨éª¼è’™çš®åŠ¨ç”» skinning </li>
</ol>
<p>è¿™äº›ä¸€èˆ¬éœ€è¦åœ¨3Då»ºæ¨¡è½¯ä»¶ä¸Š,å¦‚Blenderæ¥åˆ¶ä½œå¹¶å¯¼å‡º. é€šè¿‡æ·»åŠ ä¸åŒçš„å½¢æ€é”®,æ¥æ”¹å˜åŸæœ‰ç‰©å“çš„å½¢çŠ¶,å¹¶ä¸”é€šè¿‡æ’å…¥å…³é”®å¸§æ¥åˆ¶ä½œåŠ¨ç”».ç°åœ¨æˆ‘ä»¬ä¸»è¦äº†è§£ä¸€ä¸‹å½¢æ€é”®.</p>
<p>å½¢æ€é”®å¯ä»¥ç”±blender 2.80çš„ä¿®æ”¹å™¨æ¥æ·»åŠ ,æ·»åŠ ä¹‹ååœ¨ <strong>ç‰©ä½“æ•°æ®</strong> çš„ <strong>å½¢æ€é”®</strong> ä¸­çš„ <strong>å€¼</strong> æ¥åˆ¶ä½œåŠ¨ç”». ä¹‹åå¯¼å‡ºæˆgltfæ ¼å¼. è¦æ³¨æ„çš„æ˜¯, æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦å¯¼å‡ºæè´¨.</p>
<h2 id="å¯¼å…¥THREE-js"><a href="#å¯¼å…¥THREE-js" class="headerlink" title="å¯¼å…¥THREE.js"></a>å¯¼å…¥THREE.js</h2><p>æˆ‘ä»¬ä½¿ç”¨THREE.GLTFLoaderç±»æ¥åŠ è½½gltfæ–‡ä»¶, åœ¨åŠ è½½å‰,è¿˜éœ€è¦å£°æ˜ä¸€ä¸ªæ··åˆå™¨(mixer), </p>
<blockquote>
<p>The AnimationMixer is a player for animations on a particular object in the scene. When multiple objects in the scene are animated independently, one AnimationMixer may be used for each object.</p>
</blockquote>
<p>å®ƒæ˜¯åœºæ™¯ä¸­çš„ä¸€ä¸ªç‰©å“çš„åŠ¨ç”»æ’­æ”¾å™¨,å¦‚æœæœ‰ä¸åŒçš„ç‰©å“åŠ¨ç”»,å®ƒå¯ä»¥åˆ†åˆ«æ’­æ”¾ä»–ä»¬. å…¶æ¬¡,æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªclockç±»,ç”¨æ¥è®°å½•æ—¶é—´ç‚¹.</p>
<pre><code>let mixer
let clock = new THREE.Clock();

loader = new THREE.GLTFLoader();
loader.load(
    &quot;js/bobo.glb&quot;,
    function (gltf) {
        obScene = gltf.scene
        obScene.traverse(function (child) {
            child.material = obMtr;
            // ç»™åœºæ™¯ä¸­çš„å­å…ƒç´ æ›¿æ¢æè´¨
        });

        mixer = new THREE.AnimationMixer(gltf.scene);
        // æ··åˆå™¨,å‚æ•°æ˜¯æ ¹å…ƒç´ 

        gltf.animations.forEach((clip) =&gt; {
            mixer.clipAction(clip).play();
            // ç»™æ¯ä¸ªæ—¶é—´è½´éƒ½å¼€å§‹æ’­æ”¾
        });
    }
);

function animate(timestamp){

    ...

    if ( mixer ) mixer.update( clock.getDelta() );
    //  å¦‚æœæœ‰æ··åˆå™¨åˆ™æ›´æ–°
}
</code></pre><p>è¿™ç§æ–¹æ³•å¯ä»¥è¯•blenderæ–‡ä»¶é‡Œè®¾ç½®äº†æ—¶é—´è½´çš„ç‰©å“å¼€å§‹è¿åŠ¨,ä¸è¿‡å¦‚æœæƒ³å…‹éš†ä¸€ä¸ªå…ƒç´ ,å®ƒä¼šä¸§å°¸å®ƒçš„åŠ¨ç”»æ•ˆæœ.å…·ä½“åŸå› æš‚æ—¶ä¸æ¸…æ¥š,ä¸è¿‡åœ¨ä¸€ç¯‡gitçš„æ›´æ–°æŠ¥å‘Šé‡Œä¼¼ä¹æåˆ°äº†, SkeletonUtils.clone( object )</p>
<blockquote>
<p>Adds a helper method, SkeletonUtils.clone( object ) that preserves SkinnedMesh/Bone relationships. Ideally this would â€œjust workâ€ with the usual object.clone(), but I canâ€™t see any clean way of doing that â€” bones are not necessarily children of the SkinnedMesh(es?) theyâ€™re associated with, and trying to connect them requires logic that would need to live somewhere outside the recursive callback series. This helper method provides an easy way to work around the problem. </p>
</blockquote>
<p><em>Based on <a href="https://gist.github.com/zellski/be4e9207ab8e70c4e89062d48ce345ba#file-gltf_utils-js-L19" target="_blank" rel="noopener">https://gist.github.com/zellski/be4e9207ab8e70c4e89062d48ce345ba#file-gltf_utils-js-L19</a> by @zellski and <a href="https://gist.github.com/cdata/f2d7a6ccdec071839bc1954c32595e87" target="_blank" rel="noopener">https://gist.github.com/cdata/f2d7a6ccdec071839bc1954c32595e87</a> by @cdata.</em></p>
<p><a href="https://github.com/mrdoob/three.js/pull/14494" target="_blank" rel="noopener">link</a></p>
<p>æ ¹æ®ä¸Šæ–‡,THREEè‚¯å®šæ˜¯æ‹¥æœ‰èƒ½å¤Ÿå¤åˆ¶åŠ¨ç”»ç‰©ä½“çš„å¯èƒ½æ€§,å¹¶ä¸”è¿˜æœ‰å®ƒæ”¯æŒçš„éª¨éª¼è’™çš®åŠ¨ç”»..åº”è¯¥ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨.å€¼å¾—æ·±å…¥å­¦ä¹ ğŸ˜‚</p>
<h2 id="Some-Tips"><a href="#Some-Tips" class="headerlink" title="Some Tips"></a>Some Tips</h2><ol>
<li>In WebVR / WebVR Polyfill, the position of camera will be <strong>Fixed or follow the HMD</strong>, so if we want to supply mouse control, we should bind <strong>OrbitControl</strong> at <strong>3D Object</strong> rather than camera as common way.</li>
</ol>

			</div>
			<hr class="my-5 py-5">
			<div class="col p-2" id="disqus_thread"></div>
		</article>
		
	</div>
</div>

<div class="container-fluid">
	
</div>	
		


<script>
	(function() { // DON'T EDIT BELOW THIS LINE

	var d = document, s = d.createElement('script');
	s.src = 'https://hayden-2.disqus.com/embed.js';
	s.setAttribute('data-timestamp', +new Date());
	(d.head || d.body).appendChild(s);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            


  </div>
</div>
 
<div id="bottom-outer" class="container-fluid">
  <div id="bottom-inner" class="row">
    <div id="bottom-info" class="col">
       <i> For LCC MA.IVM Reflective Journal</i>
        <br>
        
        
            / <a class="" href="/">Home</a>
        
            / <a class="" href="/archives">Archives</a>
        
            / <a class="" href="/about">About</a>
        
        <br>
        <br>
        <p>
          Site by <a href="/about">Heyao</a> / Made by <a href="https://hexo.io/" target="_blank">HEXO</a>
        </p>
        
    </div>
  </div>
</div>


  <!-- scripts list from theme config.yml -->
  
    <script src="/js/main.js"></script>
  
    <script src="/js/jquery-3.3.1.js"></script>
  
    <script src="/js/bootstrap.js"></script>
  
    <script src="/js/parallax.js"></script>
  




<!-- Custom Theme JavaScript -->


</body>
</html>
