


<!DOCTYPE html>
<html lang="English">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NodeJs server [ Hayden&#39;s Journal ]</title>
  <meta name="baidu-site-verification" content="86burbRUA2" />
  <meta name="google-site-verification" content="OGzkUO2d_kRU2zpchWHwmxb_a-laYsIlpZ8TFBNkegg" />
  
    
      <link rel="stylesheet" href="/css/hhy.css">
    
      <link rel="stylesheet" href="/css/default.css">
    
      <link rel="stylesheet" href="/css/bootstrap.css">
    
      <link rel="stylesheet" href="/css/bootstrap-grid.css">
    
  


    <!-- Custom Fonts -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
    
  
            
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>
<body>


<div id="menu-outer">

  <div id="menu-inner">
    
    

    <nav class="navbar navbar-expand-lg navbar-light ">
      <a class="navbar-brand" href="#"> Hayden's Journal </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          
            <li><a class="nav-item nav-link " href="/">Home</a></li>
          
            <li><a class="nav-item nav-link " href="/archives">Archives</a></li>
          
            <li><a class="nav-item nav-link " href="http://heyao.art/#/about">Heyao.art</a></li>
          
          

        </div>
      </div>
    </nav>
    <!-- nav -->  
  </div>
</div>

<div id="content-outer" class="container-fluid">
  <div id="content-inner" class="row">
    

<div id="post-container" class="col-sm-12 col-md-10 offset-md-0">
	<div class="col-12"><h1 class="holder" >&nbsp</h1></div>
	
	
	<div class="row">
		
		
		<div id="post-head" class="col-12 col-md-3 m-sm-0 mr-md-5  d-md-inline-block">
			<h1 class="article-title">NodeJs server</h1>
			<span class="article-tags">
				 
					

<a class="post-tag" href="/tags/Web/">Web</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/JavaScript/">JavaScript</a>


			</span>
			<div class="post-list-box col p-0 m-0">
				<div class="col-sm-12 p-0">
	<div class="col-12"><h1 class="holder" >&nbsp</h1></div>
	
	<div id="post-list" class=" col-md-12 d-none d-sm-block mt-3 p-0">
		
		
		<h2 class="col-sm-10 float-left">All post</h2>
		<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/11/01/reflection-1st-Nov/">reflection 1st Nov</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/31/concept-sketches/">concept sketches</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/29/Reflection-1029/">Reflection 29 Oct</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/22/reflection-1022/">Reflection 22ed Oct</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/21/Grab-idea-from-free-drawing/">Grab idea from free drawing</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/21/generated-Rose/">generated Rose</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/05/what-is-the-abstract-reality/">what is the abstract reality</a></li></ul>
		<div id="post-list-more" class="col-12"><a  href="/archives">More</a></div>
	</div>
</div>
	
			</div>
		</div>

		<article id="post" class="rounded-bottom col-12 col-md  offset-md-0 p-0 ">
		  <div class="col-sm-12 col-md">
		  	<h1 id="Using-NodeJS-to-serve-with-Visualisation-on-Web"><a href="#Using-NodeJS-to-serve-with-Visualisation-on-Web" class="headerlink" title="Using NodeJS to serve with Visualisation on Web"></a>Using NodeJS to serve with Visualisation on Web</h1><p>This article focus on Web and HTTP technique at first, because in current stage I’m learning how to collect and sort data. In next article I will show the method I combine data with visuals in my work.</p>
<p>写了个开头,我决定还是用中文写.毕竟很多东西我自己都不懂.</p>
<h2 id="基本阐述"><a href="#基本阐述" class="headerlink" title="基本阐述"></a>基本阐述</h2><p>今天所有人都使用互联网,不过可能只有少数人了解它的原理.在多数人眼里,互联网可能只是很多可以相互点击,链接的网页.(实际上确实差不多) 作为数字艺术工作者,我在进行视觉可视化项目的期间接触了大量的网页相关知识,并且在未来的工作中,我可能会涉及更多的网络相关技术,所以我大概了了解了网络原理,然后现在来解释一下加深自己的认识.</p>
<p>Web的全名是,<strong>World Wide Web</strong>,直译应该是,世界范围的网络,我个人很喜欢万维网这个翻译😁.万维网的简写是 <strong>www</strong>, 我们可以发现这个就是我们非常熟悉的网址开头,三达不溜. 在讨论网址(域名)之前,我们不能忘记了另一个玩意儿,它甚至在www之前,不过我们基本很少手动输入它: <strong>http://</strong>,它的全称是 <strong>超文本传输协议</strong>,它告诉浏览器用何种方式去获得网页. 所以,我们浏览网页的步骤是:</p>
<p><strong>通过http协议,输入域名来访问一个服务器,服务器发送网页给浏览器</strong></p>
<p>这里我们知道了,之所以输入网址或者点开链接后会进入一个页面,是因为你的浏览器访问了那个服务器,服务器反手给了你一个新的页面.服务器是什么呢?在我看来,服务器就是一台24小时不关机的电脑.它既然是电脑,必然有程序来执行命令,有的程序负责通过得到的请求,来及时生成动态的网页;有的程序负责将这些网页投送给浏览器,即让用户看见. 打个比方就是,服务器是一个餐厅,浏览器(client)是一个顾客,顾客选好菜以后,通过http协议把菜单(XMLHttpRequest)请求给后台,后台厨师(如PHP,PYTHON)随手烹饪,然后交给传菜员(Apache,NodeJS)来分配菜品(HTML)给顾客.</p>
<p>其中传输协议和请求方式都有不同的好几种,我也不是很懂所以不多说了.只看最基本的.对于我来说,使用服务器来进行数据可视化的好处是,服务器能储存和读写数据,这有利于我们使用灵活的,动态的数据来进行创作.</p>
<h2 id="开始架设简单的服务器"><a href="#开始架设简单的服务器" class="headerlink" title="开始架设简单的服务器"></a>开始架设简单的服务器</h2><p>进入mac的终端</p>
<pre><code>$ mkdir &lt;name&gt;   
$ cd &lt;name&gt;
</code></pre><p>这一步我们创建了一个文件夹在电脑根目录,并且进入了它,之后的操作都会作用在这个文件夹内. 然后安装<a href="https://nodejs.org/en/" target="_blank" rel="noopener">nodeJS</a> 和<a href="https://expressjs.com/" target="_blank" rel="noopener">express</a>(nodeJS框架) </p>
<p>现在开始编写服务器脚本,并储存成js文件放在文件夹的根目录.</p>
<pre><code>let express = require(&#39;express&#39;)
let app = express()

app.get(&#39;/&#39;,(req,res)=&gt;{
    res.send(&#39;Hello,world&#39;)
})    

let server = app.listen(8081,()=&gt;{
let host = server.address().address
let port = server.address().port
console.log(`here&#39;s ${host}:${port}`);
})
</code></pre><p>通过非常简单的几步,我们创建了一个WEB服务器,并且拥有了一个最基本的功能,当有请求链接进它的接口时,它会发出回应.现在通过终端命令启动它.</p>
<pre><code>node &lt;name&gt;.js
</code></pre><p>现在,只要在浏览器输入<em>localhost:8081</em>就能访问这个服务器.8081是这个服务器的端口,目前的程序,只有访问这个端口,服务器才会发出回应. 然后我们就可以开始下一步的工作,通过访问其他公司开放的API,访问并获得数据. 因为我准备观察个体的区别,所以我准备获得一些推特上的post,之后再进行自然语言的分析.</p>
<p>先安装<a href="https://www.npmjs.com/package/twitter" target="_blank" rel="noopener">twitter for NodeJS</a>,可以很方便的调用推特的API</p>
<pre><code>$ npm install twitter
</code></pre><p>+++</p>
<pre><code>var Twitter = require(&#39;twitter&#39;);

var client = new Twitter({
    consumer_key:&#39;xxx&#39;,
    consumer_secret:&#39;xxx&#39;,
    bearer_token:&#39;xxx&#39;
});

client.get(&#39;tweets/search/30day/&lt;envName&gt;.json&#39;, {&quot;query&quot;:&quot;place:London&quot;}, function(error, tweets, response) {
    res.type(&#39;json&#39;)
    res.send(tweets)
});
</code></pre><p>xxx所代表的密码需要自己去twitter注册,并且新建一个app项目,才能获得令牌和密码来访问推特的服务器.现在来说一些client.get(url,{“query”:””},function())中,参数的意义</p>
<ol>
<li><p>链接,即通过这个链接可以访问推特API,在样例中,我使用的是高级搜索,还有基本搜索的url可以更简单的使用.如 <em><a href="https://api.twitter.com/1.1/search/tweets.json" target="_blank" rel="noopener">https://api.twitter.com/1.1/search/tweets.json</a></em></p>
</li>
<li><p>请求时发送的数据,通过这些数据,推特服务器会提供详细的,相对应的推文过来.具体格式查看<a href="https://developer.twitter.com/en/docs/tweets/rules-and-filtering/overview/operators-by-product" target="_blank" rel="noopener">作用器文档</a>,<a href="https://developer.twitter.com/en/docs/tweets/rules-and-filtering/overview/standard-operators" target="_blank" rel="noopener">标准搜索作用器</a></p>
</li>
<li><p>回馈函数, 设置了响应的类型,并发送数据给客户端</p>
</li>
</ol>
<p>以上的操作可以使服务器请求推特API并得到响应数据然后发送给客户端.而如何使服务器开始请求,提供什么样的要求去请求呢?此时我们就要使用前端脚本来命令客户端来发送数据到服务器,并把需要的请求发送出去,得到想要的数据.</p>
<h2 id="更多的服务器功能"><a href="#更多的服务器功能" class="headerlink" title="更多的服务器功能"></a>更多的服务器功能</h2><pre><code>app.get(&#39;*&#39;, function(req, res) {
    res.send(&#39;error&#39;);
});
</code></pre><p>当服务器被请求不存在的页面时,发送错误提醒.</p>
<pre><code>app.all(&#39;*&#39;, function(req, res, next) {
    res.header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);
    res.header(&quot;Access-Control-Allow-Headers&quot;, &quot;X-Requested-With&quot;);
    res.header(&quot;Access-Control-Allow-Methods&quot;,&quot;PUT,POST,GET,DELETE,OPTIONS&quot;);
    res.header(&quot;X-Powered-By&quot;,&#39; 3.2.1&#39;)
    res.header(&quot;Content-Type&quot;, &quot;application/json;charset=utf-8&quot;);
    next();
});
</code></pre><p>允许跨域.</p>

			</div>
			<hr class="my-5 py-5">
			<div  class="col p-2" id="disqus_thread"></div>
			<script>
			/**
			*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
			*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
			/*
			var disqus_config = function () {
			this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
			};
			*/
			(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');
			s.src = 'https://hayden-2.disqus.com/embed.js';
			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		</article>
		
	</div>
</div>

<div class="container-fluid">
	
</div>	
		


                            


  </div>
</div>
 
<div id="bottom-outer" class="container-fluid">
  <div id="bottom-inner" class="row">
    <div id="bottom-info" class="col">
       <i> For LCC MA.IVM Reflective Journal</i>
        <br>
        
        
            / <a class="" href="/">Home</a>
        
            / <a class="" href="/archives">Archives</a>
        
            / <a class="" href="http://heyao.art/#/about">Heyao.art</a>
        
        <br>
        <br>
        <p>
          Made by <a href="/about">Heyao</a> / Site by <a href="https://hexo.io/" target="_blank">HEXO</a>
        </p>
        
    </div>
  </div>
</div>


  <!-- scripts list from theme config.yml -->
  
    <script src="/js/main.js"></script>
  
    <script src="/js/jquery-3.3.1.js"></script>
  
    <script src="/js/bootstrap.js"></script>
  
    <script src="/js/md5.js"></script>
  
    <script src="/js/highlight.js"></script>
  




<!-- Custom Theme JavaScript -->


</body>
</html>
